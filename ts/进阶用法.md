# 进阶用法




## 理解几个关键字(typeof, keyof, in)
**这几个关键词主要用作 类型保护**

注意：此时的 `typeof` 是一个 **类型关键词**，只可以用在类型语法中。
```typescript
function padLeft(value: string, padding: string | number) {
  if (typeof padding === "number") {
      return Array(padding + 1).join(" ") + value;
  }
  if (typeof padding === "string") {
      return padding + value;
  }
  throw new Error(`Expected string or number, got '${padding}'.`);
}

```


`keyof` 是一个 **类型关键词** 。 可以获取一个 **对象接口** 所有key值, 看好它的作用对象是 `interface`。
```typescript
interface Person {
  name: string;
  age: number
}

type PersonAttrs = keyof Person // 'name' | 'age'

const person: Person = {
  name: 'aa',
  age: 2,
}

type Student = typeof person
```

`in` 也是一个 **类型关键词** ,可以对联合类型进行遍历，**只能用在 type 关键词下面**

```typescript
type Keys = 'a' | 'b'
type Obj = {
  [p in Keys]: any
}
// -> { a: any, b: any }
```




## [] 操作符
* 使用对象是: `interface`
* 使用方法: `[]` 操作符可以进行 *索引访问*
* 也是一个 **类型关键词** 
```typescript
interface Person {
  name: string
  age: number
}

type x = Person['name'] // x is string
```



## !非空断言操作符
`!` 可以用来断言操作对象是非 `null` 和 非 `undefined` 类型。
举个例子： `x!` 将从 x 值域中排除 `null` 和 `undefined`。
```typescript
const input1 = document.getElementById('number1')! as HTMLInputElement;
```





## 工具泛型
### `Record<Keys,Type>`
```typescript
type Record<K extends keyof any, T> = {
    [P in K]: T;
};
```

```typescript
interface IPageInfo {
  title: string;
}

type Page = "home" | "about" | "contact";

const nav: Record<Page, IPageInfo> = {
  home: { title: 'home' },
  about: { title: 'about' },
  contact: { title: 'contact' }
}

console.log(nav.home)  // { title: 'home' }
```



### Partial
```typescript
type Partial<T> = {
    [P in keyof T]?: T[P];
};
```


### Required
```typescript
type Required<T> = {
    [P in keyof T]-?: T[P];
};
```


### Readonly
```typescript
type Readonly<T> = {
    readonly [P in keyof T]: T[P];
};
```


### Pick
```typescript
type Pick<T, K extends keyof T> = {
    [P in K]: T[P];
};
```



### Exclude
```typescript
type Exclude<T, U> = T extends U ? never : T;
```



### Extract
```typescript
type Extract<T, U> = T extends U ? T : never;
```



### Omit
```typescript
type Omit<T, K extends keyof any> = Pick<T, Exclude<keyof T, K>>;
```



### NonNullable
```typescript
type NonNullable<T> = T extends null | undefined ? never : T;
```



### ReturnType
```typescript
type ReturnType<T extends (...args: any) => any> = T extends (...args: any) => infer R ? R : any;

```



| 名称        | 源码                                                         | 举例说明                                                     | 作用                                      |
| ----------- | ------------------------------------------------------------ | ------------------------------------------------------------ | ----------------------------------------- |
| Record      | type Record<K extends keyof any, T> = { [P in K]: T };       | type T11 = Record<'a' \| 'b' \| 'c', Person>;<br /> // { a: Person; b: Person; c: Person; } |                                           |
| Partial     | type Partial<T> = {  [P in keyof T]?: T[P]; };               | 只能用于一层                                                 | 让必选参数变成可选参数                    |
| Required    | type Required<T> = {  [P in keyof T]-?: T[P]; };             |                                                              | 让可选参数变成必选参数                    |
| Pick        | type Pick<T, K extends keyof T> = {     [P in K]: T[P]; };   | type NewPerson = Pick<Person, 'name'>; // { name: string; }  | 只选接口中的部分属性                      |
| Exclude     |                                                              |                                                              |                                           |
| ReturnType  |                                                              |                                                              | 获取方法的返回值类型                      |
| ThisType    | interface ThisType<T> { }                                    |                                                              | 是用于指定上下文对象类型的。              |
| NonNullable | type NonNullable<T> = T extends null \| undefined ? never : T; | type T22 = '123' \| '222' \| null; <br />type T23 = NonNullable<T22>; // '123' \| '222' | 用来过滤类型中的 null 及 undefined 类型。 |


