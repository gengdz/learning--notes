# JavaScript轻量级函数式编程
## 为什么使用函数式编程
* 置信度（自信心）
你通过读代码，而不是运行代码就理解这段代码能干什么事情。而不是停留在它可能是干什么的层面。我们应该对代码了如指掌，在运行代码之前就知道它肯定跑的通。
通过读代码就能对我们的程序更有信心。
* 可读性
代码的作用是人与人之间的交流。我们 *70％* 的时间花在了阅读和理解代码上。写代码就像搭建乐高。将一块一块的小元件组成我们想要的摩天大楼。
* 对自己好点
函数式编程，可以让我们更专注的描述最终的结果。命令式的代码旨在，精确地指导计算机如何完成一件事情。



## 函数基础
### 什么是函数？
`y = f(x) ` 其中 `f(x) = 2x*x + 2`。这是我们高中学习的 **方程** 。确定的输入对应确定的输出，给定一个 *x*, 就有 *y*。
为什么说 *方程** ，因为 **在某种程度上，函数式编程就是使用数学意义上的方程进行编程**



### 函数 vs 程序
程序是：一个任意的功能集合。它或许有多个输入值，或许没有。它或许有一个输出值，或许没有。
函数是：接受输入值，明确的返回输出值。



### 函数的输入
*arguments* 是你输入的值(实参)
*parameters* 是函数中的变量名称(形参)



#### 输入计数
*Arity* 。这个特有名词表示：一个函数声明的形参个数。
```javascript
function foo(x, y, z, ...args) {
    // ..
    console.log( arguments.length );    // 2
    console.log( x, y, z, args );
}
foo.length  // 3

foo();                    // undefined undefined undefined []
foo( 1, 2, 3, 4, 5 );    // 1 2 3 [ 4, 5 ]

```
1）如何获取函数的 *Arity* ?
* 可以通过 `foo.length`。其中 *length* 是只读属性。
* 每一个函数都有一个 *arguments* 对象（类数组）存放需要传入的参数。你可以通过 *arguments* 的 length 值来找出有多少传入的参数.

请注意：不要通过 `arguments[1]` 访问参数的位置。只要记住 `arguments.length`。

2）想要获取的参数没有在一个规范的位置。我们如何处理？
要使用 ES6 中的拓展运算符 `...` 来操作。
args永远是一个数组。多好，真靠谱。

3）Arity 为 1 的函数也被称为一元函数。**在函数式编程中，我们希望我们的函数在任何的情况下是一元的，有时我们甚至会使用各种技巧来将高 Arity 的函数都转换为一元的形式。**

4）通过不同的输入值让一个函数重载拥有不同的行为的技巧叫做**特定多态**（ad hoc polymorphism）。

5) **第一条原则：声明性代码通常比命令式代码更干净。**
声明式代码，如同之前代码片段里的解构，强调一段代码的输出结果。
命令式代码，像刚才我们自己手动赋值的例子，注重的是如何得到结果。
*只要可能，无论我们的语言和我们的库或框架允许我们达到什么程度，我们都应该尽可能使用声明性的和自解释的代码。*



### 函数输出
1) 在 JavaScript 中，函数只会返回一个值。
如果你没有 return 值，或者你使用 return;，那么则会隐式地返回 `undefined` 值.

2) 因为 list 使用了 nums 的引用，不是对 `[1,3,9,..]` 的值复制，而是引用复制。**因为 JS 对数组、对象和函数都使用引用和引用复制，我们可以很容易地从函数中创建输出，即使是无心的。**



### 函数功能
### 保持作用域
在所有编程，尤其是函数式编程中，最强大的就是：当一个函数内部存在另一个函数的作用域时，可以对当前函数进行操作。**当内部函数从外部函数引用变量，这被闭包**

实际上，闭包是它可以记录并且访问它作用域外的变量，甚至当这个函数在不同的作用域被执行。
闭包不仅限于获取变量的原始值：它不是快照，而是直接链接。你可以更新该值，并在下次访问时获取更新后的值。



## 管理函数的输入
### 立即传参和稍后传参
**偏函数** 严格来讲是一个减少函数参数个数 `(arity)` 的过程；这里的参数个数指的是希望传入的形参的数量。我们通过 `getOrder(..)` 把原函数 `ajax(..)` 的参数个数从 3 个减少到了 2 个。
`getOrder(data,cb)` 是 `ajax(url,data,cb)` 函数的偏函数（partially-applied functions）。该术语代表的概念是：在函数调用现场（function call-site），将实参应用（apply） 于形参。如你所见，我们一开始仅应用了部分实参 —— 具体是将实参应用到 url 形参 —— 剩下的实参稍后再应用。



## 减少副作用
### 数学上的幂等
数学上的幂等指的是：**`f(x)` 与 `f(f(x))`、 `f(f(f(x)))` 等 有相同的输出**
典型的数学例子为： `Math.abs()` (取绝对值)。类似的还有 `Math.min()`、`Math.max()`、`Math.round()`、`Math.floor()` 和 `Math.ceil()`等。



### 编程中的幂等
编程中的幂等没有那么严格。它指的是：**`f(x)` 与 `f(x)` 等 有相同的输出。即 第 *n* 次调用 `f(x)` 的结果和 第 *1* 次调用 `f(x)` 的结果相同**



### 纯粹
```javascript
const PI = 3.141592;

function circleArea(radius) {
    return PI * radius * radius;
}

function cylinderVolume(radius,height) {
    return height * circleArea( radius );
}
```
说明：
`circleArea(..)` 中引用了自由变量 *PI*，但是这是一个常量所以不是一个侧因。`cylinderVolume(..)` 引用了自由变量 `circleArea`，这也不是一个侧因，因为这个程序把它当作一个常量引用它的函数值。这两个函数都是纯的。

