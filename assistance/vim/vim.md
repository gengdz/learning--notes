# vim

gcc 是一款编译器，只负责程序的翻译
gdb 是一款调试器，只负责程序的调试

vim 是文本编辑器

## 模式

常用模式一共有 _4_ 种

- 普通模式：默认模式
- 插入模式：编辑文件的地方
- 可视模式：可以选中字符
- 命令模式：

### 模式的切换

1. 普通模式到插入模式：

   - `i` 在光标前插入
   - `I` 在行首插入
   - `a` 在当前光标的后面插入
   - `A` 在行尾插入
   - `o` 在下一行插入。 o -> oneLine
   - `O` 在上一行插入

2. 插模式到普通模式

   - `ESC` | `jj` | `<C-[>`

3. 普通模式到可视模式 | 可视模式到普通模式

   - `v`

4. 普通模式到命令模式

   - `:`

5. 命令模式到普通模式
   - `ESC`

## 按键

- x 删除当前光标所在的字符
- X 删除当前字符左边的光标
- D 删除到行尾
- C 删除到行尾，进入插入模式
- r 替换字符，当前字符，替换成紧接着的输入字符
- R 进入替代模式，将当前及之后的字符都替代为紧跟着输入的字符串，直到按 Esc 返回 Normal 模式
- s 删除光标所在字符，并进入插入模式。4s 删除前面 4 个字符，并进入插入模式
- S 删除当前所在行，并进入插入模式。

## 光标移动

- i (inner) 表示这个里面的
- a (around) 表示环绕，包括这个的

下面是一些衍生

- iw / aw
- i( / a(
- i{ / a{
- i{ / a{
- i< / a<
- it / at 标签
- is / as 句子
- ip / ap 段落

## mark

- m a 添加文件内的标记
- ` | ' a 跳转到 a 标记
- m A 添加全局的标记
- ` | ' A 跳转的全局的标记
- :marks 查看全部的标记

## 操作符

- d(delete) 删除
- c(change) 修改（删除并进入插入模式）
- y(yank) 复制
- v(visual) 选中并进入 VISVAL 模式

u 撤销
`<C-r>` 反撤销
2dd 删除 2 行

## 操作符 + 动作

- diw 删除这个单词
- ci< 修改 <string> -> <number>
- di{ 删除 {} 里面的内容

## 切换大小写

- ~ 将光标下的字母改变大小写
- 3~ 将从光标开始的位置改变 3 个字母的大小写
- g~~ 改变当前行字母的大小写
- gUU 将当前行的字母改成大写
- guu 将当前行的字母改成小写
- gUaw(gUiw) 将当前光标下的单词改成大写
- guaw(guiw) 将当前光标下的单词改成小写

## 宏

- 以 q 开始，+ 加一个字母作为宏的名字。比如 qa
- 开始对其中的一行进行操作。
- 按 q 完成录制
- 按下 @a 使用宏，或者 使用 n@a 的方式重复多次，也可以使用 @@ 来重复最近调用过的宏。

如果录制了一个宏 qa，但是发现需要给宏追加命令，可以使用 qA 的方式进行追加。vim 会进行录制，但是会将他们追加在寄存器 a 中。

## tips

- gd go definition 跳转到定义
- gh go hover 鼠标悬浮 `<C-o>` 回来
- gt 向后切换 tab 页。 2gt 向后跳转 2 个
- gT 向前切换 tab 页
- cmd + 0 跳转到左侧 cmd + 1 跳转到右侧 使用空格把它打开，也可以用 l 这样光标也就在右边了
- 使用 command + 数字跳转到不同的分栏
- 2g; 作用是跳转到上上次编辑的地方。比方说忘记定义了一个变量，这时候去补充好定义的声明，然后就可以使用 `2g;` 跳转回来继续编写了。
- `<C-a>` 是递增数字，`<C-x>` 是递减数字。使用方为：10 ctl a 实现增加 10 。`<C-v> g <C-a>` 生成递增的数字。

- vim 的语法只有一条额外规则，即当一个操作符命令被连续调用两次时，它会作用于当前行。所以 dd 删除当前行。
- Va{d 删除整个函数。
- gj 跳转到肉眼意义上的下一行。有的文本本质是一行，但是由于展示的宽度有限导致了还行，可以通过 gj 的方式去选中。

## easymotion

空格 空格 s e 查找 e

## sneak

- `s <char> <char>` 查找字符
- `S <char> <char>` 向上查找字符

## vim-surround

- cs " ' 修改包裹。修改双引号为 '
- ys iw ' 添加包裹。可以把 test 变成 'test'
- ds" 删除已经存在的包裹。从 "test" -> test。 dst 删除标签
- 选中之后，S " 为选中的部分添加 "

## Multi-Cursor Mode

使用 gb 可以进入到多光标模式

## 代码

- zc 折叠光标下代码块 close one fold under the cursor
- zC 递归折叠光标下的所有代码块 Open all folds under the cursor recursively
- zo 展开代码块 open one fold under the cursor
- zO 递归展开光标下的所有代码块
- = 格式化代码
- zM 折叠所有（折叠更多，more）
- zR 打开所有折叠（reduce）
- 「zr」 和 「zm」 来打开和关闭若干层嵌套的折叠。（目前没生效）
- vim.foldfix 滚动的时候，不自动打开折叠
- zj 移动到下一个折叠（目前没生效）
- zk 移动到上一个折叠（目前没生效）
- zf 创建折叠。
  - zf10（从当前位置折叠 10 行）
  - zfgg（从当前位置折叠到行首）
  - zfG（从当前位置折叠到行尾）

## 剪切操作

- x 删除当前光标所在的字符
- X 删除当前光标左边的字符
- dd 删除本行
- ndd 删除 n 行
- d2j 向下删除 2 行
- d2k 向上删除 2 行，包括当前行，共 3 行
- dl 向后删除 1 个字符
- D 或者 d$ 删除到本行尾
- d^ 或者 d0 删除到本行头
- xp 交换两个字符的顺序
- dj 删除上一行
- dk 删除下一行
- 3daw 删除 3 个单词；复制的话，可以考虑下 y3aw

## 复制粘贴

- yy / Y 复制一行
- nyy 复制当前行以下 n 行，ndd 删除当前行以下 n 行
- y4k 向上复制 4 行

## vim 查找

- / 可以实现向下查找。n 下一个，N 上一个
- ? 可以实现向上查找。n 上一个，N 下一个

## vim 替换

> :{作用范围}s/{目标}/{替换}/{替换标志}

其中：

- 如果「作用范围」是 `%`，表示全局替换

使用示例

| 作用               | 命令                |
| ------------------ | ------------------- |
| 全文替换           | `:%s/foo/bar/g`     |
| 当前行替换         | `:s/foo/bar/g`      |
| 选中替换           | `:'<,'>s/foo/bar/g` |
| 5-12 行替换        | `:5,12s/foo/bar/g`  |
| 当前行和后两行替换 | `:.,+2s/foo/bar/g`  |

## vim 匹配

### 精确匹配查找单词

- `\<` 只匹配单词的开头。可以用：`/the\>`，找到以 "the" 结尾的单词
- `\>` 只匹配单词的结尾。可以用 `\<the` 找到 the 开头的单词。
- `\<word\>` 匹配完整单词。要匹配一个完整的单词 "the"，只需：`/\<the\>`

## . 命令

重复上一次的操作。重复的是操作，不是内容。

## 普通模式

- `40i#esc` 重复 40 次 #
- `n<Enter>` 光标向下移动 n 行
- `>G` 增加当前行到文档末尾处的缩进层级

## 插入模式

- `<C-a>` 移动到开头
- `<C-e>` 移动到结尾
- `<C-b>` 往前移动鼠标
- `<C-f>` 往后移动鼠标
- `<C-h>` 删除光标前的一个字符
- `<C-w>` 删除光标前的一个单词
- `<C-d>` 删除光标后的一个字符（终端可用）
- `<C-u>` 删除至行首
- `<C-o>` 可以在插入模式执行一次普通模式的命令，然后再回到插入模式
- `<C-r>%` 可以将当前文件名输入到文件中

- `<C-v>[u]{code}` 通过字符编码，插入字符。通过 ga 可以知道某个字符的编码 unicode
- `<C-k>{char1}{char2}` 用二合字母的方式的方式插入非常用字符，比如插入 ½ ，可以使用 `C-k 12`。所有的二合字母可以使用 `:h digraph-table`。比如：ﬁ ，可以使用：`C-k fi`

## 可视模式

- 使用 o 切换选择区的活动端。高亮选区的范围由其两个端点界定。在选择的过程中如果发现端点位置不对，不需要重新选择，只需要按 o 就可以重新调整选区的边界
- gv 重新选择上次选中的内容
- `<C-v>` 块选择模式

## 命令模式

### 打开文件

- `vim test.md` 打开这个文件
- `vim + test.md` 打开这个文件并将光标置于最后一行
- `vim + n test.md` 打开这个文件并将光标置于第 n 行
- `vim + /string test.md` 打开这个文件并高亮 string 按 n 进行切换
- `vim test1.md test2.md` 代表同时打开多个文件
- 末行模式下使用 :next 或者 :n 切换到下一个文件 使用 :prev 切换到上一个文件

### 其他

- `<C-r>` `<C-w>` 将光标下的单词复制到命令行
- :set nu 显示行号
- :syntax on 语法高亮
- :set nonu 取消显示行号
- /string 高亮 string
- :noh 取消高亮，配置了快捷键：`C-n`
- num1,num3 co num4 把 num1 到 num3 的内容复制到 num4 的后面
- w 保存 w! 强制保存
- q 退出 !q 强制退出
- wq 保存并退出 !wq 强制保存并退出
- `:'<,'>g/^$/d` 删除多个空行。g 是 goto（以行为单位）；正则指定匹配到的行；d 是执行删除命令。
- \v 使用正则（目前看起来没有生效）

### 补充

如果未保存则会生成 .swap 文件，这时候可以可以使用 `rm test.swap` 就会执行删除操作

### 配色

使用 :colorscheme 显示当前的主题配色，默认是 default
使用 :colorscheme `<C-d>` 显示所有的主题
使用 :colorscheme 配色名 就可以修改配色

## 配置

### tab 大小

```bash
vim.o.softtabstop = 4
vim.o.shiftwidth = 4
vim.o.extandtab = true
```

## 键盘映射

可以使用命令 `:h key-notation` 来查看对应的映射
