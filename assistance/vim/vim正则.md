# vim 正则

## 关于 range 的表达式

`range` 表示检索范围，如果不指定则表示当前行。

| 表达式及元字符 | 说明                                   |
| -------------- | -------------------------------------- |
| `\<`           | 匹配单词词首                           |
| `\>`           | 匹配单词词尾                           |
| 'm             | 包含标记位置 m 的行                    |
| %              | 整个文档，即每一行，所有行，等价于 1,$ |
| 1              | 文档的第一行                           |
| $              | 行尾；整个文档的最后一行               |
| ^              | 行首                                   |
| 0              | 虚行，表示第一行的上方                 |
| .              | 当前行                                 |



## 关于 flags 的元字符 

| 命令执行标记 | 说明             |
| ------------ | ---------------- |
| `g`          | 行中所有的匹配点 |
| `c`          | 执行前确认       |
| `i`          | 忽略大小写       |



## vim 关于数量的元字符

| vim          | perl     | 意义                         |
| ------------ | -------- | ---------------------------- |
| `*`          | `*`      | 任意数量                     |
| `\+`         | `+`      | 1 个或者多个                 |
| `\?` 或 `\=` | `?`      | 0 个或者 1 个                |
| `\{n,m}`     | `{n,m}`  | n 个到 m 个                  |
| `\{n,}`      | `{n,}`   | n 个到无限个，最少 n 个      |
| `\{,m}`      | `{,m}`   | 0 个到 m 个，最多 m 个       |
| `\{n}`       | `{n}`    | n 个                         |
| `\{-n,m}`    | `{n,m}?` | n 个到 m 个,禁止贪婪         |
| `\{-}`       | `*?`     | 任意数量，禁止贪婪           |
| `\{-1,}`     | `+?`     | 表示 1 个或者多个，禁止贪婪  |
| `\{-,1}`     | `??`     | 表示 0 个或者 1 个，禁止贪婪 |



## vim 断言匹配

| vim    | perl    | 意义                   |
| ------ | ------- | ---------------------- |
| `\@=`  | `(?=)`  | 匹配后面是什么的内容   |
| `\@!`  | `(?!)`  | 匹配后面不是什么的内容 |
| `\@<=` | `(?<=)` | 匹配前面是什么的内容   |
| `\@<!` | `(?<!)` | 匹配前面不是什么的内容 |
| <!--   | `\@=`   | `(?:)`                 | 不记录到分组 | --> |



## vim 替换表达式的示例


| 表达式示例   | 解释                   |
| ------------ | ---------------------- |
| `%s/^/new/g` | 在每一行的行首插入 new |
| `%s/$/new/g` | 在每一行的行尾插入 new |



## vim 原子组
`\|` 就是或的意思，表示两者中的一个。

| vim          | perl  | 解释   |
| ------------ | ----- | ------ |
| `/vim\|perl` | `(vim | perl)` | 匹配 `vim` 或 `perl` |



## 引用分组


pattern 中圆括号中包含的部分就是分组，后面可以使用 `\n` 进行引用。

原字符串：Ctrl + a 递增 ctrl + x 递减
目标字符串: `<C-a>` 递增 `<C-x>` 递减
```bash
:%s/Ctrl + \(.\)/`<C-\1>`/gci
```
其中：
`\1` 引用 pattern 中第 1 个分组 匹配到的字符串



## 替换内容的特殊字符
### & 符号
`&` 替换为模式的匹配，也即如果 `pattern` 匹配 `helloworld`，那么 `&` 就引用 `helloworld`。

示例 1：
```bash
:s/man/&,&,what/gc
```
man 被替换成 man,man,what


示例 2：
```bash
:s/.*/{&}/g
```
没有指定 range，则仅在当前行匹配查找，所以上面的命令就是将当前行加了一个大括号 {}。




## 模式

### very magic

`\v` very magic 模式，即除了 `_`、数字、字母之外的所有字符都具有特殊含义。



### very magic

`\V` very nomagic 模式，只表示自身，
